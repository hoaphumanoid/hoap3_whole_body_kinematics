function [q_right, q_dot_right, p_right, R_right, q_left, q_dot_left, p_left, R_left] = right_leg_support (T, Ts, q0_right_r, q0_left_r, delta_right, Rd0_right, delta_left, Rd0_left)
% inverse kinematics settings
Kp=2e2*eye(3);
Ko=5e0*eye(3);

%***********************
% supporting right leg *
%***********************
delta_x_right = delta_right(1);
delta_y_right = delta_right(2);
delta_z_right = delta_right(3);

% pass from robot reference to matlab reference
[Rr_m2r, Rl_m2r] = rotate_matrix();
q0_right=Rr_m2r'*q0_right_r;

% initial conditions
[R0_right, p0_right] = evaluate_position_right (q0_right);          %initial position and orientation of the right supporting leg

% determine the desired trajectory for the supporting right leg 
[xd_right, xd_dot_right] = trajectory_leg_supporting (T, Ts, p0_right, delta_x_right, delta_y_right, delta_z_right);

% determine the desired orientations for the supporting right leg 
[Rd_right, wd_right] = desired_orientations (T, Ts, Rd0_right);

% inverse kinematics
[q_right_m, q_dot_right_m, p_right, R_right, error_p, error_o] = inverse_kinematics_right (Ts, T, q0_right, Kp, Ko, xd_right, xd_dot_right, Rd_right, wd_right);

q_right = Rr_m2r*q_right_m;
q_dot_right = Rr_m2r*q_dot_right_m;

%********************
% floating left leg *
%********************
delta_x_left = delta_left(1);
delta_y_left = delta_left(2);
delta_z_left = delta_left(3);

%pass from robot reference to matlab reference
q0_left=Rl_m2r'*q0_left_r;

% initial conditions
[R0_left, p0_left] = evaluate_position_left (q0_left);              %initial position and orientation of the left floating leg

% determine the desired trajectory for the floating left leg 
[xd_left, xd_dot_left] = trajectory_leg_floating (T, Ts, p0_left, delta_x_left, delta_y_left, delta_z_left);

% determine the desired orientations for the supporting right leg 
[Rd_left, wd_left] = desired_orientations (T, Ts, Rd0_left);

% inverse kinematics
[q_left_m, q_dot_left_m, p_left, R_left, error_p, error_o] = inverse_kinematics_left (Ts, T, q0_left, Kp, Ko, xd_left, xd_dot_left, Rd_left, wd_left);

q_left = Rl_m2r*q_left_m;
q_dot_left = Rl_m2r*q_dot_left_m;

function [q, q_dot, p, R, error_p, error_o] = inverse_kinematics_right (Ts, T, q0, Kp, Ko,  xd, xd_dot, Rd, wd)
%initialization
iterations = T/Ts;
error_p=zeros(3,iterations);
error_o=zeros(3,iterations);
q=zeros(6,iterations);
q_dot=zeros(6,iterations);
R=zeros(3,3,iterations);
p=zeros(3,iterations);
q(:,1) = q0;

for kk = 1:iterations-1
    %desired quaternion
    [eta_d, eps_d] = rot2quat (Rd(:,:,kk));
    %present position
    [R(:,:,kk), p(:,kk)] = evaluate_position_right (q(:,kk));
    %present quaternion
    [eta, eps] = rot2quat (R(:,:,kk));
    %errors
    error_p(:,kk) = xd(:,kk) - p(:,kk);
    error_o(:,kk) = eta*eps_d - eta_d*eps - matrix_S(wd)*eps;
    %present velocity
    q_dot(:,kk) = inv(evaluate_jacobian_right(q(:,kk)))*[xd_dot(:,kk) + Kp*error_p(:,kk); wd(:,kk) + Ko*error_o(:,kk)];
    %next q
    q(:,kk+1) = q(:,kk) + q_dot(:,kk)*Ts;
end
[R(:,:,iterations), p(:,iterations)] = evaluate_position_right (q(:,iterations));
[eta, eps] = rot2quat (R(:,:,iterations));
error_p(:,iterations) = xd(:,iterations) - p(:,iterations);
error_o(:,iterations) = eta*eps_d - eta_d*eps - matrix_S(wd)*eps;

%****%

function [R, p] = evaluate_position_right (q)
p = [   -sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6));
        cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6));
        sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*sin(q(2))];
 
 
 
R = [   -sin(q(1))*(cos(q(2))*(cos(q(3))*(cos(q(4))*sin(q(5))*cos(q(6))+sin(q(4))*sin(q(6)))-sin(q(3))*(sin(q(4))*sin(q(5))*cos(q(6))-cos(q(4))*sin(q(6))))-sin(q(2))*(sin(q(3))*(cos(q(4))*sin(q(5))*cos(q(6))+sin(q(4))*sin(q(6)))+cos(q(3))*(sin(q(4))*sin(q(5))*cos(q(6))-cos(q(4))*sin(q(6)))))+cos(q(1))*cos(q(5))*cos(q(6)), -sin(q(1))*(cos(q(2))*(cos(q(3))*(-cos(q(4))*sin(q(5))*sin(q(6))+sin(q(4))*cos(q(6)))-sin(q(3))*(-sin(q(4))*sin(q(5))*sin(q(6))-cos(q(4))*cos(q(6))))-sin(q(2))*(sin(q(3))*(-cos(q(4))*sin(q(5))*sin(q(6))+sin(q(4))*cos(q(6)))+cos(q(3))*(-sin(q(4))*sin(q(5))*sin(q(6))-cos(q(4))*cos(q(6)))))-cos(q(1))*cos(q(5))*sin(q(6)),                                                                                                                                                            -sin(q(1))*(cos(q(2))*(cos(q(3))*cos(q(4))*cos(q(5))-sin(q(3))*sin(q(4))*cos(q(5)))-sin(q(2))*(sin(q(3))*cos(q(4))*cos(q(5))+cos(q(3))*sin(q(4))*cos(q(5))))-cos(q(1))*sin(q(5));
        cos(q(1))*(cos(q(2))*(cos(q(3))*(cos(q(4))*sin(q(5))*cos(q(6))+sin(q(4))*sin(q(6)))-sin(q(3))*(sin(q(4))*sin(q(5))*cos(q(6))-cos(q(4))*sin(q(6))))-sin(q(2))*(sin(q(3))*(cos(q(4))*sin(q(5))*cos(q(6))+sin(q(4))*sin(q(6)))+cos(q(3))*(sin(q(4))*sin(q(5))*cos(q(6))-cos(q(4))*sin(q(6)))))+sin(q(1))*cos(q(5))*cos(q(6)),  cos(q(1))*(cos(q(2))*(cos(q(3))*(-cos(q(4))*sin(q(5))*sin(q(6))+sin(q(4))*cos(q(6)))-sin(q(3))*(-sin(q(4))*sin(q(5))*sin(q(6))-cos(q(4))*cos(q(6))))-sin(q(2))*(sin(q(3))*(-cos(q(4))*sin(q(5))*sin(q(6))+sin(q(4))*cos(q(6)))+cos(q(3))*(-sin(q(4))*sin(q(5))*sin(q(6))-cos(q(4))*cos(q(6)))))-sin(q(1))*cos(q(5))*sin(q(6)),                                                                                                                                                             cos(q(1))*(cos(q(2))*(cos(q(3))*cos(q(4))*cos(q(5))-sin(q(3))*sin(q(4))*cos(q(5)))-sin(q(2))*(sin(q(3))*cos(q(4))*cos(q(5))+cos(q(3))*sin(q(4))*cos(q(5))))-sin(q(1))*sin(q(5));
        sin(q(2))*(cos(q(3))*(cos(q(4))*sin(q(5))*cos(q(6))+sin(q(4))*sin(q(6)))-sin(q(3))*(sin(q(4))*sin(q(5))*cos(q(6))-cos(q(4))*sin(q(6))))+cos(q(2))*(sin(q(3))*(cos(q(4))*sin(q(5))*cos(q(6))+sin(q(4))*sin(q(6)))+cos(q(3))*(sin(q(4))*sin(q(5))*cos(q(6))-cos(q(4))*sin(q(6)))),                                                sin(q(2))*(cos(q(3))*(-cos(q(4))*sin(q(5))*sin(q(6))+sin(q(4))*cos(q(6)))-sin(q(3))*(-sin(q(4))*sin(q(5))*sin(q(6))-cos(q(4))*cos(q(6))))+cos(q(2))*(sin(q(3))*(-cos(q(4))*sin(q(5))*sin(q(6))+sin(q(4))*cos(q(6)))+cos(q(3))*(-sin(q(4))*sin(q(5))*sin(q(6))-cos(q(4))*cos(q(6)))),                                                                                                                                                                                                sin(q(2))*(cos(q(3))*cos(q(4))*cos(q(5))-sin(q(3))*sin(q(4))*cos(q(5)))+cos(q(2))*(sin(q(3))*cos(q(4))*cos(q(5))+cos(q(3))*sin(q(4))*cos(q(5)))];
 
    
%****%

function J = evaluate_jacobian_right (q)

J = [	-cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))-39/500*sin(q(1))*cos(q(5))*cos(q(6)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             sin(q(1))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*sin(q(2))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sin(q(1))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sin(q(1))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))-21/200*sin(q(2))*cos(q(3))-21/200*cos(q(2))*sin(q(3))),                                                                                                                                                                                                                                            (-(cos(q(1))*cos(q(2))*cos(q(3))-cos(q(1))*sin(q(2))*sin(q(3)))*sin(q(4))+(-cos(q(1))*cos(q(2))*sin(q(3))-cos(q(1))*sin(q(2))*cos(q(3)))*cos(q(4)))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))-21/200*sin(q(2))*cos(q(3))-21/200*cos(q(2))*sin(q(3)))-(-(sin(q(2))*cos(q(3))+cos(q(2))*sin(q(3)))*sin(q(4))+(-sin(q(2))*sin(q(3))+cos(q(2))*cos(q(3)))*cos(q(4)))*(cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6))-21/200*cos(q(1))*cos(q(2))*cos(q(3))+21/200*cos(q(1))*sin(q(2))*sin(q(3))-21/200*cos(q(1))*cos(q(2))),                                                                                                                                                                                                (((cos(q(1))*cos(q(2))*cos(q(3))-cos(q(1))*sin(q(2))*sin(q(3)))*cos(q(4))+(-cos(q(1))*cos(q(2))*sin(q(3))-cos(q(1))*sin(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))-sin(q(1))*sin(q(5)))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))-21/200*sin(q(2))*cos(q(3))-21/200*cos(q(2))*sin(q(3)))-((sin(q(2))*cos(q(3))+cos(q(2))*sin(q(3)))*cos(q(4))+(-sin(q(2))*sin(q(3))+cos(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))*(cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6))-21/200*cos(q(1))*cos(q(2))*cos(q(3))+21/200*cos(q(1))*sin(q(2))*sin(q(3))-21/200*cos(q(1))*cos(q(2)));
        -sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -cos(q(1))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*sin(q(2))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -cos(q(1))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -cos(q(1))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))-21/200*sin(q(2))*cos(q(3))-21/200*cos(q(2))*sin(q(3))),                                                                                                                                                                                                                                           (-(sin(q(2))*cos(q(3))+cos(q(2))*sin(q(3)))*sin(q(4))+(-sin(q(2))*sin(q(3))+cos(q(2))*cos(q(3)))*cos(q(4)))*(-sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6))+21/200*sin(q(1))*cos(q(2))*cos(q(3))-21/200*sin(q(1))*sin(q(2))*sin(q(3))+21/200*sin(q(1))*cos(q(2)))-(-(-sin(q(1))*cos(q(2))*cos(q(3))+sin(q(1))*sin(q(2))*sin(q(3)))*sin(q(4))+(sin(q(1))*cos(q(2))*sin(q(3))+sin(q(1))*sin(q(2))*cos(q(3)))*cos(q(4)))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))-21/200*sin(q(2))*cos(q(3))-21/200*cos(q(2))*sin(q(3))),                                                                                                                                                                                               ((sin(q(2))*cos(q(3))+cos(q(2))*sin(q(3)))*cos(q(4))+(-sin(q(2))*sin(q(3))+cos(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))*(-sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6))+21/200*sin(q(1))*cos(q(2))*cos(q(3))-21/200*sin(q(1))*sin(q(2))*sin(q(3))+21/200*sin(q(1))*cos(q(2)))-(((-sin(q(1))*cos(q(2))*cos(q(3))+sin(q(1))*sin(q(2))*sin(q(3)))*cos(q(4))+(sin(q(1))*cos(q(2))*sin(q(3))+sin(q(1))*sin(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))-cos(q(1))*sin(q(5)))*(sin(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))+cos(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))-21/200*sin(q(2))*cos(q(3))-21/200*cos(q(2))*sin(q(3)));
        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             cos(q(1))*(cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6)))-sin(q(1))*(-sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cos(q(1))*(cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6))-21/200*cos(q(1))*cos(q(2)))-sin(q(1))*(-sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6))+21/200*sin(q(1))*cos(q(2))),                                                                                                                                                                                                                                                                                                                                                                                   cos(q(1))*(cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6))-21/200*cos(q(1))*cos(q(2))*cos(q(3))+21/200*cos(q(1))*sin(q(2))*sin(q(3))-21/200*cos(q(1))*cos(q(2)))-sin(q(1))*(-sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6))+21/200*sin(q(1))*cos(q(2))*cos(q(3))-21/200*sin(q(1))*sin(q(2))*sin(q(3))+21/200*sin(q(1))*cos(q(2))),                                                                     (-(-sin(q(1))*cos(q(2))*cos(q(3))+sin(q(1))*sin(q(2))*sin(q(3)))*sin(q(4))+(sin(q(1))*cos(q(2))*sin(q(3))+sin(q(1))*sin(q(2))*cos(q(3)))*cos(q(4)))*(cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6))-21/200*cos(q(1))*cos(q(2))*cos(q(3))+21/200*cos(q(1))*sin(q(2))*sin(q(3))-21/200*cos(q(1))*cos(q(2)))-(-(cos(q(1))*cos(q(2))*cos(q(3))-cos(q(1))*sin(q(2))*sin(q(3)))*sin(q(4))+(-cos(q(1))*cos(q(2))*sin(q(3))-cos(q(1))*sin(q(2))*cos(q(3)))*cos(q(4)))*(-sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6))+21/200*sin(q(1))*cos(q(2))*cos(q(3))-21/200*sin(q(1))*sin(q(2))*sin(q(3))+21/200*sin(q(1))*cos(q(2))), (((-sin(q(1))*cos(q(2))*cos(q(3))+sin(q(1))*sin(q(2))*sin(q(3)))*cos(q(4))+(sin(q(1))*cos(q(2))*sin(q(3))+sin(q(1))*sin(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))-cos(q(1))*sin(q(5)))*(cos(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*sin(q(1))*cos(q(5))*cos(q(6))-21/200*cos(q(1))*cos(q(2))*cos(q(3))+21/200*cos(q(1))*sin(q(2))*sin(q(3))-21/200*cos(q(1))*cos(q(2)))-(((cos(q(1))*cos(q(2))*cos(q(3))-cos(q(1))*sin(q(2))*sin(q(3)))*cos(q(4))+(-cos(q(1))*cos(q(2))*sin(q(3))-cos(q(1))*sin(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))-sin(q(1))*sin(q(5)))*(-sin(q(1))*(cos(q(2))*(cos(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))-sin(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*cos(q(3)))-sin(q(2))*(sin(q(3))*(39/500*cos(q(4))*sin(q(5))*cos(q(6))+39/500*sin(q(4))*sin(q(6)))+cos(q(3))*(39/500*sin(q(4))*sin(q(5))*cos(q(6))-39/500*cos(q(4))*sin(q(6)))+21/200*sin(q(3)))+21/200*cos(q(2)))+39/500*cos(q(1))*cos(q(5))*cos(q(6))+21/200*sin(q(1))*cos(q(2))*cos(q(3))-21/200*sin(q(1))*sin(q(2))*sin(q(3))+21/200*sin(q(1))*cos(q(2)));
        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -(-sin(q(1))*cos(q(2))*cos(q(3))+sin(q(1))*sin(q(2))*sin(q(3)))*sin(q(4))+(sin(q(1))*cos(q(2))*sin(q(3))+sin(q(1))*sin(q(2))*cos(q(3)))*cos(q(4)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ((-sin(q(1))*cos(q(2))*cos(q(3))+sin(q(1))*sin(q(2))*sin(q(3)))*cos(q(4))+(sin(q(1))*cos(q(2))*sin(q(3))+sin(q(1))*sin(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))-cos(q(1))*sin(q(5));
        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       sin(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       sin(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       sin(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -(cos(q(1))*cos(q(2))*cos(q(3))-cos(q(1))*sin(q(2))*sin(q(3)))*sin(q(4))+(-cos(q(1))*cos(q(2))*sin(q(3))-cos(q(1))*sin(q(2))*cos(q(3)))*cos(q(4)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ((cos(q(1))*cos(q(2))*cos(q(3))-cos(q(1))*sin(q(2))*sin(q(3)))*cos(q(4))+(-cos(q(1))*cos(q(2))*sin(q(3))-cos(q(1))*sin(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))-sin(q(1))*sin(q(5));
        1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -(sin(q(2))*cos(q(3))+cos(q(2))*sin(q(3)))*sin(q(4))+(-sin(q(2))*sin(q(3))+cos(q(2))*cos(q(3)))*cos(q(4)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ((sin(q(2))*cos(q(3))+cos(q(2))*sin(q(3)))*cos(q(4))+(-sin(q(2))*sin(q(3))+cos(q(2))*cos(q(3)))*sin(q(4)))*cos(q(5))];


function [q, q_dot, p, R, error_p, error_o] = inverse_kinematics_left (Ts, T, q0, Kp, Ko,  xd, xd_dot, Rd, wd)
%initialization
iterations = T/Ts;
error_p=zeros(3,iterations);
error_o=zeros(3,iterations);
q=zeros(6,iterations);
q_dot=zeros(6,iterations);
R=zeros(3,3,iterations);
p=zeros(3,iterations);
q(:,1) = q0;

for kk = 1:iterations-1
    %desired quaternion
    [eta_d, eps_d] = rot2quat (Rd(:,:,kk));
    %present position
    [R(:,:,kk), p(:,kk)] = evaluate_position_left (q(:,kk));
    %present quaternion
    [eta, eps] = rot2quat (R(:,:,kk));
    %errors
    error_p(:,kk) = xd(:,kk) - p(:,kk);
    error_o(:,kk) = eta*eps_d - eta_d*eps - matrix_S(wd)*eps;
    %present velocity
    q_dot(:,kk) = inv(evaluate_jacobian_left(q(:,kk)))*[xd_dot(:,kk) + Kp*error_p(:,kk); wd(:,kk) + Ko*error_o(:,kk)];
    %next q
    q(:,kk+1) = q(:,kk) + q_dot(:,kk)*Ts;
end
[R(:,:,iterations), p(:,iterations)] = evaluate_position_left (q(:,iterations));
[eta, eps] = rot2quat (R(:,:,iterations));
error_p(:,iterations) = xd(:,iterations) - p(:,iterations);
error_o(:,iterations) = eta*eps_d - eta_d*eps - matrix_S(wd)*eps;

%****%

function [R, p] = evaluate_position_left (q)
R =	[cos(q(1))*(sin(q(2))*(cos(q(3))*(-cos(q(4))*cos(q(5))*sin(q(6))+sin(q(4))*sin(q(5))*sin(q(6)))-sin(q(3))*(-sin(q(4))*cos(q(5))*sin(q(6))-cos(q(4))*sin(q(5))*sin(q(6))))+cos(q(2))*cos(q(6)))+sin(q(1))*(-sin(q(3))*(-cos(q(4))*cos(q(5))*sin(q(6))+sin(q(4))*sin(q(5))*sin(q(6)))-cos(q(3))*(-sin(q(4))*cos(q(5))*sin(q(6))-cos(q(4))*sin(q(5))*sin(q(6)))),                                                                                                                 cos(q(1))*sin(q(2))*(cos(q(3))*(-cos(q(4))*sin(q(5))-sin(q(4))*cos(q(5)))-sin(q(3))*(-sin(q(4))*sin(q(5))+cos(q(4))*cos(q(5))))+sin(q(1))*(-sin(q(3))*(-cos(q(4))*sin(q(5))-sin(q(4))*cos(q(5)))-cos(q(3))*(-sin(q(4))*sin(q(5))+cos(q(4))*cos(q(5)))), cos(q(1))*(sin(q(2))*(cos(q(3))*(-cos(q(4))*cos(q(5))*cos(q(6))+sin(q(4))*sin(q(5))*cos(q(6)))-sin(q(3))*(-sin(q(4))*cos(q(5))*cos(q(6))-cos(q(4))*sin(q(5))*cos(q(6))))-cos(q(2))*sin(q(6)))+sin(q(1))*(-sin(q(3))*(-cos(q(4))*cos(q(5))*cos(q(6))+sin(q(4))*sin(q(5))*cos(q(6)))-cos(q(3))*(-sin(q(4))*cos(q(5))*cos(q(6))-cos(q(4))*sin(q(5))*cos(q(6))));
	sin(q(1))*(sin(q(2))*(cos(q(3))*(-cos(q(4))*cos(q(5))*sin(q(6))+sin(q(4))*sin(q(5))*sin(q(6)))-sin(q(3))*(-sin(q(4))*cos(q(5))*sin(q(6))-cos(q(4))*sin(q(5))*sin(q(6))))+cos(q(2))*cos(q(6)))-cos(q(1))*(-sin(q(3))*(-cos(q(4))*cos(q(5))*sin(q(6))+sin(q(4))*sin(q(5))*sin(q(6)))-cos(q(3))*(-sin(q(4))*cos(q(5))*sin(q(6))-cos(q(4))*sin(q(5))*sin(q(6)))),                                                                                                                 sin(q(1))*sin(q(2))*(cos(q(3))*(-cos(q(4))*sin(q(5))-sin(q(4))*cos(q(5)))-sin(q(3))*(-sin(q(4))*sin(q(5))+cos(q(4))*cos(q(5))))-cos(q(1))*(-sin(q(3))*(-cos(q(4))*sin(q(5))-sin(q(4))*cos(q(5)))-cos(q(3))*(-sin(q(4))*sin(q(5))+cos(q(4))*cos(q(5)))), sin(q(1))*(sin(q(2))*(cos(q(3))*(-cos(q(4))*cos(q(5))*cos(q(6))+sin(q(4))*sin(q(5))*cos(q(6)))-sin(q(3))*(-sin(q(4))*cos(q(5))*cos(q(6))-cos(q(4))*sin(q(5))*cos(q(6))))-cos(q(2))*sin(q(6)))-cos(q(1))*(-sin(q(3))*(-cos(q(4))*cos(q(5))*cos(q(6))+sin(q(4))*sin(q(5))*cos(q(6)))-cos(q(3))*(-sin(q(4))*cos(q(5))*cos(q(6))-cos(q(4))*sin(q(5))*cos(q(6))));
    -cos(q(2))*(cos(q(3))*(-cos(q(4))*cos(q(5))*sin(q(6))+sin(q(4))*sin(q(5))*sin(q(6)))-sin(q(3))*(-sin(q(4))*cos(q(5))*sin(q(6))-cos(q(4))*sin(q(5))*sin(q(6))))+sin(q(2))*cos(q(6)),                                                                                                                                                                                                                                                             -cos(q(2))*(cos(q(3))*(-cos(q(4))*sin(q(5))-sin(q(4))*cos(q(5)))-sin(q(3))*(-sin(q(4))*sin(q(5))+cos(q(4))*cos(q(5)))),                                                                                                                                                                                           -cos(q(2))*(cos(q(3))*(-cos(q(4))*cos(q(5))*cos(q(6))+sin(q(4))*sin(q(5))*cos(q(6)))-sin(q(3))*(-sin(q(4))*cos(q(5))*cos(q(6))-cos(q(4))*sin(q(5))*cos(q(6))))-sin(q(2))*sin(q(6))];
 
p = [   cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)));
        sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)));
        -cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))];
    
%****%

function J = evaluate_jacobian_left (q)

J = [-sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cos(q(1))*cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -sin(q(1))*cos(q(2))^2*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-sin(q(2))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        sin(q(1))*cos(q(2))*(-cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+21/200*cos(q(2))*cos(q(3)))-sin(q(2))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*sin(q(1))*sin(q(2))*cos(q(3))-21/200*cos(q(1))*sin(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sin(q(1))*cos(q(2))*(-cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+21/200*cos(q(2))*cos(q(3))*cos(q(4))-21/200*cos(q(2))*sin(q(3))*sin(q(4))+21/200*cos(q(2))*cos(q(3)))-sin(q(2))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*cos(q(4))-21/200*(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*sin(q(4))-21/200*sin(q(1))*sin(q(2))*cos(q(3))-21/200*cos(q(1))*sin(q(3))),                                                                                                                                                                                                                                                                                                                                                                  (((sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*cos(q(4))+(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*sin(q(4)))*sin(q(5))-(-(sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*sin(q(4))+(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*cos(q(4)))*cos(q(5)))*(-cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+21/200*cos(q(2))*cos(q(3))*cos(q(4))-21/200*cos(q(2))*sin(q(3))*sin(q(4))+21/200*cos(q(2))*cos(q(3)))-((-cos(q(2))*cos(q(3))*cos(q(4))+cos(q(2))*sin(q(3))*sin(q(4)))*sin(q(5))-(cos(q(2))*cos(q(3))*sin(q(4))+cos(q(2))*sin(q(3))*cos(q(4)))*cos(q(5)))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*cos(q(4))-21/200*(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*sin(q(4))-21/200*sin(q(1))*sin(q(2))*cos(q(3))-21/200*cos(q(1))*sin(q(3)));
    cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sin(q(1))*cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      sin(q(2))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3))))+cos(q(1))*cos(q(2))^2*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        sin(q(2))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*cos(q(1))*sin(q(2))*cos(q(3))+21/200*sin(q(1))*sin(q(3)))-cos(q(1))*cos(q(2))*(-cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+21/200*cos(q(2))*cos(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sin(q(2))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*cos(q(4))-21/200*(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*sin(q(4))-21/200*cos(q(1))*sin(q(2))*cos(q(3))+21/200*sin(q(1))*sin(q(3)))-cos(q(1))*cos(q(2))*(-cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+21/200*cos(q(2))*cos(q(3))*cos(q(4))-21/200*cos(q(2))*sin(q(3))*sin(q(4))+21/200*cos(q(2))*cos(q(3))),                                                                                                                                                                                                                                                                                                                                                                  ((-cos(q(2))*cos(q(3))*cos(q(4))+cos(q(2))*sin(q(3))*sin(q(4)))*sin(q(5))-(cos(q(2))*cos(q(3))*sin(q(4))+cos(q(2))*sin(q(3))*cos(q(4)))*cos(q(5)))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*cos(q(4))-21/200*(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*sin(q(4))-21/200*cos(q(1))*sin(q(2))*cos(q(3))+21/200*sin(q(1))*sin(q(3)))-(((cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*cos(q(4))+(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*sin(q(4)))*sin(q(5))-(-(cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*sin(q(4))+(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*cos(q(4)))*cos(q(5)))*(-cos(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+21/200*cos(q(2))*cos(q(3))*cos(q(4))-21/200*cos(q(2))*sin(q(3))*sin(q(4))+21/200*cos(q(2))*cos(q(3)));
    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sin(q(1))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3))))+cos(q(1))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cos(q(1))*cos(q(2))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3))))-sin(q(1))*cos(q(2))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 cos(q(1))*cos(q(2))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*sin(q(1))*sin(q(2))*cos(q(3))-21/200*cos(q(1))*sin(q(3)))-sin(q(1))*cos(q(2))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*cos(q(1))*sin(q(2))*cos(q(3))+21/200*sin(q(1))*sin(q(3))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cos(q(1))*cos(q(2))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*cos(q(4))-21/200*(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*sin(q(4))-21/200*sin(q(1))*sin(q(2))*cos(q(3))-21/200*cos(q(1))*sin(q(3)))-sin(q(1))*cos(q(2))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*cos(q(4))-21/200*(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*sin(q(4))-21/200*cos(q(1))*sin(q(2))*cos(q(3))+21/200*sin(q(1))*sin(q(3))), (((cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*cos(q(4))+(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*sin(q(4)))*sin(q(5))-(-(cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*sin(q(4))+(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*cos(q(4)))*cos(q(5)))*(sin(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))-cos(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*cos(q(4))-21/200*(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*sin(q(4))-21/200*sin(q(1))*sin(q(2))*cos(q(3))-21/200*cos(q(1))*sin(q(3)))-(((sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*cos(q(4))+(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*sin(q(4)))*sin(q(5))-(-(sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*sin(q(4))+(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*cos(q(4)))*cos(q(5)))*(cos(q(1))*sin(q(2))*(21/200*cos(q(3))*cos(q(4))-21/200*sin(q(3))*sin(q(4))+21/200*cos(q(3)))+sin(q(1))*(-21/200*sin(q(3))*cos(q(4))-21/200*cos(q(3))*sin(q(4))-21/200*sin(q(3)))-21/200*(cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*cos(q(4))-21/200*(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*sin(q(4))-21/200*cos(q(1))*sin(q(2))*cos(q(3))+21/200*sin(q(1))*sin(q(3)));
    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            sin(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 cos(q(1))*cos(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 cos(q(1))*cos(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 cos(q(1))*cos(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ((cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*cos(q(4))+(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*sin(q(4)))*sin(q(5))-(-(cos(q(1))*sin(q(2))*cos(q(3))-sin(q(1))*sin(q(3)))*sin(q(4))+(-cos(q(1))*sin(q(2))*sin(q(3))-sin(q(1))*cos(q(3)))*cos(q(4)))*cos(q(5));
    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -cos(q(1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sin(q(1))*cos(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sin(q(1))*cos(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sin(q(1))*cos(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ((sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*cos(q(4))+(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*sin(q(4)))*sin(q(5))-(-(sin(q(1))*sin(q(2))*cos(q(3))+cos(q(1))*sin(q(3)))*sin(q(4))+(-sin(q(1))*sin(q(2))*sin(q(3))+cos(q(1))*cos(q(3)))*cos(q(4)))*cos(q(5));
    1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            sin(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            sin(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            sin(q(2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (-cos(q(2))*cos(q(3))*cos(q(4))+cos(q(2))*sin(q(3))*sin(q(4)))*sin(q(5))-(cos(q(2))*cos(q(3))*sin(q(4))+cos(q(2))*sin(q(3))*cos(q(4)))*cos(q(5))];

%****%

function S = matrix_S (w)
S = [       0,  -w(3),   w(2);
         w(3),      0,  -w(1);
        -w(2),   w(1),     0];
    
%****
function [eta, eps] = rot2quat (R)
eta=real(1/2*sqrt(R(1,1)+R(2,2)+R(3,3)+1));
eps=real(1/2*[   sign(R(3,2)-R(2,3))*sqrt(R(1,1)-R(2,2)-R(3,3)+1);
            sign(R(1,3)-R(3,1))*sqrt(R(2,2)-R(1,1)-R(3,3)+1);
            sign(R(2,1)-R(1,2))*sqrt(R(3,3)-R(1,1)-R(2,2)+1)]);


function [R_right, R_left] = rotate_matrix()
R_right =   [   0, 0, 0, 0, 0, 1;
                0, 0, 0, 0,-1, 0;
                0, 0, 0, 1, 0, 0;
                0, 0,-1, 0, 0, 0;
                0,-1, 0, 0, 0, 0;
                1, 0, 0, 0, 0, 0];

R_left =    [   1, 0, 0, 0, 0, 0;
                0, 1, 0, 0, 0, 0;
                0, 0, 1, 0, 0, 0;
                0, 0, 0,-1, 0, 0;
                0, 0, 0, 0,-1, 0;
                0, 0, 0, 0, 0,-1];